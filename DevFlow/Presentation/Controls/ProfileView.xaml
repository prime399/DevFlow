<UserControl x:Class="DevFlow.Presentation.Controls.ProfileView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <ScrollViewer VerticalScrollBarVisibility="Auto"
                  HorizontalScrollBarVisibility="Disabled"
                  Background="{StaticResource AppBackgroundBrush}">
        <StackPanel Spacing="32" Padding="32">

            <!-- Page Title -->
            <TextBlock Text="Profile"
                       FontFamily="{StaticResource AppFontFamilySemiBold}"
                       FontSize="{StaticResource FontSizeHeader}"
                       Foreground="{StaticResource TextPrimaryBrush}" />

            <!-- Profile Card -->
            <Border Background="{StaticResource SurfaceBrush}"
                    CornerRadius="12"
                    Padding="24">
                
                <!-- Not Signed In State -->
                <StackPanel x:Name="SignedOutPanel" 
                            Spacing="24"
                            HorizontalAlignment="Center"
                            Visibility="Visible">
                    
                    <StackPanel Spacing="8" HorizontalAlignment="Center">
                        <FontIcon Glyph="{StaticResource IconGlyphAuth}"
                                  FontSize="48"
                                  Foreground="{StaticResource TextMutedBrush}"
                                  HorizontalAlignment="Center" />
                        <TextBlock Text="Sign in to sync your data"
                                   FontFamily="{StaticResource AppFontFamilyMedium}"
                                   FontSize="{StaticResource FontSizeSubtitle}"
                                   Foreground="{StaticResource TextPrimaryBrush}"
                                   HorizontalAlignment="Center" />
                        <TextBlock Text="Save your API requests and collections to the cloud"
                                   FontFamily="{StaticResource AppFontFamily}"
                                   FontSize="{StaticResource FontSizeBody}"
                                   Foreground="{StaticResource TextMutedBrush}"
                                   HorizontalAlignment="Center"
                                   TextWrapping="Wrap"
                                   MaxWidth="400"
                                   TextAlignment="Center" />
                    </StackPanel>

                    <!-- Google Sign In Button -->
                    <Button x:Name="GoogleSignInButton"
                            Click="GoogleSignInButton_Click"
                            HorizontalAlignment="Center"
                            Background="{StaticResource SurfaceVariantBrush}"
                            BorderThickness="1"
                            BorderBrush="{StaticResource BorderBrush}"
                            CornerRadius="8"
                            Padding="24,12">
                        <StackPanel Orientation="Horizontal" Spacing="12">
                            <!-- Google Icon -->
                            <Viewbox Width="20" Height="20">
                                <PathIcon Data="M12.545 10.239v3.821h5.445c-0.712 2.315-2.647 3.972-5.445 3.972-3.332 0-6.033-2.701-6.033-6.032s2.701-6.032 6.033-6.032c1.498 0 2.866 0.549 3.921 1.453l2.814-2.814C17.503 2.988 15.139 2 12.545 2 7.021 2 2.543 6.477 2.543 12s4.478 10 10.002 10c8.396 0 10.249-7.85 9.426-11.748l-9.426-0.013z"
                                          Foreground="{StaticResource TextSecondaryBrush}" />
                            </Viewbox>
                            <TextBlock Text="Sign in with Google"
                                       FontFamily="{StaticResource AppFontFamilySemiBold}"
                                       FontSize="{StaticResource FontSizeBody}"
                                       Foreground="{StaticResource TextPrimaryBrush}"
                                       VerticalAlignment="Center" />
                        </StackPanel>
                    </Button>

                    <!-- Callback URL Input (for completing OAuth - fallback method) -->
                    <Border x:Name="CallbackInputSection"
                            Background="{StaticResource SurfaceVariantBrush}"
                            CornerRadius="8"
                            Padding="16"
                            Visibility="Collapsed">
                        <StackPanel Spacing="12">
                            <TextBlock Text="After signing in, paste the redirect URL here:"
                                       FontFamily="{StaticResource AppFontFamily}"
                                       FontSize="{StaticResource FontSizeSmall}"
                                       Foreground="{StaticResource TextSecondaryBrush}"
                                       TextWrapping="Wrap" />
                            <TextBox x:Name="CallbackUrlTextBox"
                                     PlaceholderText="devflow://auth/callback?code=..."
                                     Background="{StaticResource SurfaceBrush}"
                                     BorderBrush="{StaticResource BorderBrush}"
                                     CornerRadius="6"
                                     Padding="12,10" />
                            <Button x:Name="SubmitCallbackButton"
                                    Click="SubmitCallbackButton_Click"
                                    HorizontalAlignment="Center"
                                    Background="{StaticResource AccentPrimaryBrush}"
                                    CornerRadius="6"
                                    Padding="20,10">
                                <TextBlock Text="Complete Sign In"
                                           FontFamily="{StaticResource AppFontFamilyMedium}"
                                           FontSize="{StaticResource FontSizeBody}"
                                           Foreground="{StaticResource SurfaceBrush}" />
                            </Button>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>

            <!-- Signed In Profile Card -->
            <Border x:Name="SignedInPanel"
                    Background="{StaticResource SurfaceBrush}"
                    CornerRadius="12"
                    Padding="24"
                    Visibility="Collapsed">
                <Grid RowDefinitions="Auto,Auto,Auto" ColumnDefinitions="Auto,*">
                    
                    <!-- Avatar -->
                    <Grid Grid.Row="0" Grid.Column="0" 
                          Width="80" Height="80"
                          Margin="0,0,24,0">
                        <!-- Initials fallback -->
                        <Ellipse Fill="{StaticResource AccentPrimaryBrush}" />
                        <TextBlock x:Name="ProfileInitials"
                                   Text="?"
                                   FontFamily="{StaticResource AppFontFamilySemiBold}"
                                   FontSize="{StaticResource FontSizeHeader}"
                                   Foreground="{StaticResource SurfaceBrush}"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center" />
                        
                        <!-- Avatar Image -->
                        <Ellipse x:Name="ProfileAvatarEllipse" Visibility="Collapsed">
                            <Ellipse.Fill>
                                <ImageBrush x:Name="ProfileAvatarBrush" Stretch="UniformToFill" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>

                    <!-- User Info -->
                    <StackPanel Grid.Row="0" Grid.Column="1" 
                                VerticalAlignment="Center"
                                Spacing="4">
                        <TextBlock x:Name="ProfileDisplayName"
                                   Text="User Name"
                                   FontFamily="{StaticResource AppFontFamilySemiBold}"
                                   FontSize="{StaticResource FontSizeTitle}"
                                   Foreground="{StaticResource TextPrimaryBrush}" />
                        <TextBlock x:Name="ProfileEmail"
                                   Text="email@example.com"
                                   FontFamily="{StaticResource AppFontFamily}"
                                   FontSize="{StaticResource FontSizeBody}"
                                   Foreground="{StaticResource TextSecondaryBrush}" />
                    </StackPanel>

                    <!-- Separator -->
                    <Border Grid.Row="1" Grid.ColumnSpan="2"
                            Height="1"
                            Background="{StaticResource BorderBrush}"
                            Margin="0,24" />

                    <!-- Sign Out Button -->
                    <Button x:Name="SignOutButton"
                            Grid.Row="2" Grid.ColumnSpan="2"
                            Click="SignOutButton_Click"
                            HorizontalAlignment="Left"
                            Background="Transparent"
                            BorderThickness="1"
                            BorderBrush="{StaticResource ErrorBrush}"
                            CornerRadius="8"
                            Padding="16,10">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xF3B1;"
                                      FontSize="14"
                                      Foreground="{StaticResource ErrorBrush}" />
                            <TextBlock Text="Sign Out"
                                       FontFamily="{StaticResource AppFontFamilyMedium}"
                                       FontSize="{StaticResource FontSizeBody}"
                                       Foreground="{StaticResource ErrorBrush}" />
                        </StackPanel>
                    </Button>
                </Grid>
            </Border>

            <!-- Cloud Sync Features Info -->
            <Border Background="{StaticResource SurfaceBrush}"
                    CornerRadius="12"
                    Padding="24">
                <StackPanel Spacing="16">
                    <TextBlock Text="Cloud Sync Features"
                               FontFamily="{StaticResource AppFontFamilySemiBold}"
                               FontSize="{StaticResource FontSizeSubtitle}"
                               Foreground="{StaticResource TextPrimaryBrush}" />
                    
                    <StackPanel Spacing="12">
                        <!-- Feature 1 -->
                        <StackPanel Orientation="Horizontal" Spacing="12">
                            <FontIcon Glyph="{StaticResource IconGlyphCloud}"
                                      FontSize="16"
                                      Foreground="{StaticResource AccentPrimaryBrush}" />
                            <TextBlock Text="Sync requests across devices"
                                       FontFamily="{StaticResource AppFontFamily}"
                                       FontSize="{StaticResource FontSizeBody}"
                                       Foreground="{StaticResource TextSecondaryBrush}" />
                        </StackPanel>
                        
                        <!-- Feature 2 -->
                        <StackPanel Orientation="Horizontal" Spacing="12">
                            <FontIcon Glyph="{StaticResource IconGlyphCollection}"
                                      FontSize="16"
                                      Foreground="{StaticResource AccentPrimaryBrush}" />
                            <TextBlock Text="Save and organize collections"
                                       FontFamily="{StaticResource AppFontFamily}"
                                       FontSize="{StaticResource FontSizeBody}"
                                       Foreground="{StaticResource TextSecondaryBrush}" />
                        </StackPanel>
                        
                        <!-- Feature 3 -->
                        <StackPanel Orientation="Horizontal" Spacing="12">
                            <FontIcon Glyph="{StaticResource IconGlyphHistory}"
                                      FontSize="16"
                                      Foreground="{StaticResource AccentPrimaryBrush}" />
                            <TextBlock Text="Access request history"
                                       FontFamily="{StaticResource AppFontFamily}"
                                       FontSize="{StaticResource FontSizeBody}"
                                       Foreground="{StaticResource TextSecondaryBrush}" />
                        </StackPanel>
                        
                        <!-- Feature 4 -->
                        <StackPanel Orientation="Horizontal" Spacing="12">
                            <FontIcon Glyph="{StaticResource IconGlyphEnvironment}"
                                      FontSize="16"
                                      Foreground="{StaticResource AccentPrimaryBrush}" />
                            <TextBlock Text="Share environments with your team"
                                       FontFamily="{StaticResource AppFontFamily}"
                                       FontSize="{StaticResource FontSizeBody}"
                                       Foreground="{StaticResource TextSecondaryBrush}" />
                        </StackPanel>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- Loading Overlay -->
            <Grid x:Name="LoadingOverlay" 
                  Visibility="Collapsed"
                  Background="#80000000">
                <StackPanel HorizontalAlignment="Center" 
                            VerticalAlignment="Center"
                            Spacing="16">
                    <ProgressRing IsActive="True" Width="48" Height="48" />
                    <TextBlock Text="Signing in..."
                               FontFamily="{StaticResource AppFontFamily}"
                               FontSize="{StaticResource FontSizeBody}"
                               Foreground="{StaticResource TextPrimaryBrush}" />
                </StackPanel>
            </Grid>
        </StackPanel>
    </ScrollViewer>
</UserControl>
